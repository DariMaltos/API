{
  "openapi": "3.0.0",
  "info": {
    "title": "API Joyería",
    "version": "1.0.0",
    "description": "API para gestionar clientes, joyas y ventas de una joyería."
  },
  "servers": [
    {
      "url": "https://api-production-ba7c.up.railway.app",
      "description": "Servidor en producción"
    },
    {
      "url": "http://localhost:3000",
      "description": "Servidor local"
    }
  ],
  "paths": {
    "/api/clientes": {
      "get": {
        "summary": "Obtiene la lista de clientes",
        "tags": ["Clientes"],
        "responses": {
          "200": {
            "description": "Lista de clientes obtenida correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Cliente"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Error al consultar clientes"
          }
        }
      },
      "post": {
        "summary": "Crea un nuevo cliente",
        "tags": ["Clientes"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ClienteInput"
              },
              "examples": {
                "clienteEjemplo": {
                  "summary": "Ejemplo de creación de cliente",
                  "value": {
                    "nombre": "Alan",
                    "telefono": "8671234567",
                    "email": "alan@example.com"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Cliente creado correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Cliente"
                }
              }
            }
          },
          "400": {
            "description": "Datos incompletos o inválidos"
          },
          "500": {
            "description": "Error al crear cliente"
          }
        }
      }
    },
    "/api/clientes/{id}": {
      "get": {
        "summary": "Obtiene un cliente por ID",
        "tags": ["Clientes"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID del cliente"
          }
        ],
        "responses": {
          "200": {
            "description": "Cliente encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Cliente"
                }
              }
            }
          },
          "404": {
            "description": "Cliente no encontrado"
          },
          "500": {
            "description": "Error al consultar cliente"
          }
        }
      },
      "put": {
        "summary": "Actualiza un cliente por ID",
        "tags": ["Clientes"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID del cliente a actualizar"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ClienteInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Cliente actualizado correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Cliente"
                }
              }
            }
          },
          "400": {
            "description": "Datos incompletos o inválidos"
          },
          "404": {
            "description": "Cliente no encontrado"
          },
          "500": {
            "description": "Error al actualizar cliente"
          }
        }
      },
      "patch": {
        "summary": "Actualiza parcialmente un cliente por ID",
        "tags": ["Clientes"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID del cliente a actualizar"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "nombre": {
                    "type": "string",
                    "example": "Daris"
                  },
                  "telefono": {
                    "type": "string",
                    "example": "8670000000"
                  },
                  "email": {
                    "type": "string",
                    "example": "daris@example.com"
                  }
                },
                "description": "Campos a actualizar (todos opcionales)"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Cliente actualizado parcialmente"
          },
          "400": {
            "description": "No se enviaron campos para actualizar"
          },
          "404": {
            "description": "Cliente no encontrado"
          },
          "500": {
            "description": "Error al actualizar cliente parcialmente"
          }
        }
      },
      "delete": {
        "summary": "Elimina un cliente por ID",
        "tags": ["Clientes"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID del cliente a eliminar"
          }
        ],
        "responses": {
          "200": {
            "description": "Cliente eliminado correctamente"
          },
          "404": {
            "description": "Cliente no encontrado"
          },
          "500": {
            "description": "Error al eliminar cliente"
          }
        }
      }
    },

    "/api/joyas": {
      "get": {
        "summary": "Obtiene la lista de joyas",
        "tags": ["Joyas"],
        "responses": {
          "200": {
            "description": "Lista de joyas obtenida correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Joya"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Error al consultar joyas"
          }
        }
      },
      "post": {
        "summary": "Crea una nueva joya",
        "tags": ["Joyas"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/JoyaInput"
              },
              "examples": {
                "joyaEjemplo": {
                  "summary": "Ejemplo de creación de joya",
                  "value": {
                    "sku": "AR01",
                    "nombre": "Anillo acero",
                    "tipo": "Anillo",
                    "material": "Acero",
                    "talla": "7",
                    "precio": 250,
                    "stock": 10
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Joya creada correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Joya"
                }
              }
            }
          },
          "400": {
            "description": "Datos incompletos o inválidos"
          },
          "500": {
            "description": "Error al crear joya"
          }
        }
      }
    },
    "/api/joyas/{id}": {
      "get": {
        "summary": "Obtiene una joya por ID",
        "tags": ["Joyas"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID de la joya"
          }
        ],
        "responses": {
          "200": {
            "description": "Joya encontrada",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Joya"
                }
              }
            }
          },
          "404": {
            "description": "Joya no encontrada"
          },
          "500": {
            "description": "Error al consultar joya"
          }
        }
      },
      "put": {
        "summary": "Actualiza una joya por ID",
        "tags": ["Joyas"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID de la joya a actualizar"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/JoyaInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Joya actualizada correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Joya"
                }
              }
            }
          },
          "400": {
            "description": "Datos incompletos o inválidos"
          },
          "404": {
            "description": "Joya no encontrada"
          },
          "500": {
            "description": "Error al actualizar joya"
          }
        }
      },
      "patch": {
        "summary": "Actualiza parcialmente una joya por ID",
        "tags": ["Joyas"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID de la joya a actualizar"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "sku": {
                    "type": "string",
                    "example": "AR01"
                  },
                  "nombre": {
                    "type": "string",
                    "example": "Anillo acero actualizado"
                  },
                  "tipo": {
                    "type": "string",
                    "example": "Anillo"
                  },
                  "material": {
                    "type": "string",
                    "example": "Acero"
                  },
                  "talla": {
                    "type": "string",
                    "example": "7"
                  },
                  "precio": {
                    "type": "number",
                    "format": "float",
                    "example": 220
                  },
                  "stock": {
                    "type": "integer",
                    "example": 12
                  }
                },
                "description": "Campos a actualizar (todos opcionales)"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Joya actualizada parcialmente"
          },
          "400": {
            "description": "No se enviaron campos para actualizar"
          },
          "404": {
            "description": "Joya no encontrada"
          },
          "500": {
            "description": "Error al actualizar joya parcialmente"
          }
        }
      },
      "delete": {
        "summary": "Elimina una joya por ID",
        "tags": ["Joyas"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID de la joya a eliminar"
          }
        ],
        "responses": {
          "200": {
            "description": "Joya eliminada correctamente"
          },
          "404": {
            "description": "Joya no encontrada"
          },
          "500": {
            "description": "Error al eliminar joya"
          }
        }
      }
    },

    "/api/ventas": {
      "get": {
        "summary": "Obtiene la lista de ventas",
        "tags": ["Ventas"],
        "responses": {
          "200": {
            "description": "Lista de ventas obtenida correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Venta"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Error al consultar ventas"
          }
        }
      },
      "post": {
        "summary": "Crea una nueva venta",
        "tags": ["Ventas"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VentaInput"
              },
              "examples": {
                "ventaEjemplo": {
                  "summary": "Ejemplo de creación de venta",
                  "value": {
                    "id_joya": 1,
                    "id_cliente": 1,
                    "cantidad": 2,
                    "precio_unit": 250,
                    "total": 500,
                    "fecha": "2025-12-02",
                    "nota": "Venta de prueba"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Venta creada correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Venta"
                }
              }
            }
          },
          "400": {
            "description": "Datos incompletos o inválidos"
          },
          "500": {
            "description": "Error al crear venta"
          }
        }
      }
    },
    "/api/ventas/{id_venta}": {
      "get": {
        "summary": "Obtiene una venta por ID",
        "tags": ["Ventas"],
        "parameters": [
          {
            "name": "id_venta",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID de la venta"
          }
        ],
        "responses": {
          "200": {
            "description": "Venta encontrada",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Venta"
                }
              }
            }
          },
          "404": {
            "description": "Venta no encontrada"
          },
          "500": {
            "description": "Error al consultar venta"
          }
        }
      },
      "put": {
        "summary": "Actualiza una venta por ID",
        "tags": ["Ventas"],
        "parameters": [
          {
            "name": "id_venta",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID de la venta a actualizar"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VentaInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Venta actualizada correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Venta"
                }
              }
            }
          },
          "400": {
            "description": "Datos incompletos o inválidos"
          },
          "404": {
            "description": "Venta no encontrada"
          },
          "500": {
            "description": "Error al actualizar venta"
          }
        }
      },
      "patch": {
        "summary": "Actualiza parcialmente una venta por ID",
        "tags": ["Ventas"],
        "parameters": [
          {
            "name": "id_venta",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID de la venta a actualizar"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "id_joya": {
                    "type": "integer",
                    "example": 1
                  },
                  "id_cliente": {
                    "type": "integer",
                    "example": 1
                  },
                  "cantidad": {
                    "type": "integer",
                    "example": 3
                  },
                  "precio_unit": {
                    "type": "number",
                    "format": "float",
                    "example": 500
                  },
                  "total": {
                    "type": "number",
                    "format": "float",
                    "example": 1500
                  },
                  "fecha": {
                    "type": "string",
                    "format": "date-time",
                    "example": "2025-12-03T12:00:00Z"
                  },
                  "nota": {
                    "type": "string",
                    "example": "Venta actualizada desde PATCH"
                  }
                },
                "description": "Campos a actualizar (todos opcionales)"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Venta actualizada parcialmente"
          },
          "400": {
            "description": "No se enviaron campos para actualizar"
          },
          "404": {
            "description": "Venta no encontrada"
          },
          "500": {
            "description": "Error al actualizar venta parcialmente"
          }
        }
      },
      "delete": {
        "summary": "Elimina una venta por ID",
        "tags": ["Ventas"],
        "parameters": [
          {
            "name": "id_venta",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID de la venta a eliminar"
          }
        ],
        "responses": {
          "200": {
            "description": "Venta eliminada correctamente"
          },
          "404": {
            "description": "Venta no encontrada"
          },
          "500": {
            "description": "Error al eliminar venta"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Cliente": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "example": 1
          },
          "nombre": {
            "type": "string",
            "example": "Alan"
          },
          "telefono": {
            "type": "string",
            "example": "8671234567"
          },
          "email": {
            "type": "string",
            "example": "alan@example.com"
          }
        }
      },
      "ClienteInput": {
        "type": "object",
        "required": ["nombre", "telefono", "email"],
        "properties": {
          "nombre": {
            "type": "string",
            "example": "Alan"
          },
          "telefono": {
            "type": "string",
            "example": "8671234567"
          },
          "email": {
            "type": "string",
            "example": "alan@example.com"
          }
        }
      },
      "Joya": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "example": 1
          },
          "sku": {
            "type": "string",
            "example": "AR01"
          },
          "nombre": {
            "type": "string",
            "example": "Anillo acero"
          },
          "tipo": {
            "type": "string",
            "example": "Anillo"
          },
          "material": {
            "type": "string",
            "example": "Acero"
          },
          "talla": {
            "type": "string",
            "example": "7"
          },
          "precio": {
            "type": "number",
            "format": "float",
            "example": 250
          },
          "stock": {
            "type": "integer",
            "example": 10
          },
          "creado_en": {
            "type": "string",
            "format": "date-time",
            "example": "2025-12-02T10:00:00Z"
          }
        }
      },
      "JoyaInput": {
        "type": "object",
        "required": ["sku", "nombre", "precio"],
        "properties": {
          "sku": {
            "type": "string",
            "example": "AR01"
          },
          "nombre": {
            "type": "string",
            "example": "Anillo acero"
          },
          "tipo": {
            "type": "string",
            "example": "Anillo"
          },
          "material": {
            "type": "string",
            "example": "Acero"
          },
          "talla": {
            "type": "string",
            "example": "7"
          },
          "precio": {
            "type": "number",
            "format": "float",
            "example": 250
          },
          "stock": {
            "type": "integer",
            "example": 10
          }
        }
      },
      "Venta": {
        "type": "object",
        "properties": {
          "id_venta": {
            "type": "integer",
            "example": 1
          },
          "id_joya": {
            "type": "integer",
            "example": 1
          },
          "id_cliente": {
            "type": "integer",
            "example": 1
          },
          "cantidad": {
            "type": "integer",
            "example": 2
          },
          "precio_unit": {
            "type": "number",
            "format": "float",
            "example": 250
          },
          "total": {
            "type": "number",
            "format": "float",
            "example": 500
          },
          "fecha": {
            "type": "string",
            "format": "date",
            "example": "2025-12-02"
          },
          "nota": {
            "type": "string",
            "example": "Venta de prueba"
          }
        }
      },
      "VentaInput": {
        "type": "object",
        "required": ["id_joya", "id_cliente", "cantidad", "precio_unit", "total"],
        "properties": {
          "id_joya": {
            "type": "integer",
            "example": 1
          },
          "id_cliente": {
            "type": "integer",
            "example": 1
          },
          "cantidad": {
            "type": "integer",
            "example": 2
          },
          "precio_unit": {
            "type": "number",
            "format": "float",
            "example": 250
          },
          "total": {
            "type": "number",
            "format": "float",
            "example": 500
          },
          "fecha": {
            "type": "string",
            "format": "date",
            "example": "2025-12-02"
          },
          "nota": {
            "type": "string",
            "example": "Venta de prueba"
          }
        }
      }
    }
  }
}
